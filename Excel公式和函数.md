## 公式和函数的操作技巧

### 突出显示公式单元格

目的：区分常数单元格和使用了公式的单元格

显示公式 Ctrl + ~

用颜色突出显示公式单元格：查找和选择 -> 公式 -> 颜色填充

用颜色突出显示常数单元格：点击任意单元格 -> 查找和选择 -> 定位条件 -> 勾选常量、数字-> 颜色填充

### 审计工具

如果工作表中有很多公式， 修改数据会对哪些单元格有影响

跟踪单元格公式的技巧：

向下跟踪从属单元格:

1. Ctrl + Shift + ]
2. 公式 -> 追踪从属单元格（连续点击）

向上跟踪从属单元格来源

1. Ctrl + Shift + [
2. 公式 -> 追踪引用单元格（连续点击）

### 整行和整列引用

选中单元格, 双击单元格的上下边框可以跳转到列表的顶部和底部

自动求和：`alt + =`

求和选中整列时文本单元格会被忽略

### 快速赋值公式或数据到整列

确认数据有填充到整列 Ctrl + ↑ / ↓

### 将公式转换为值

经过处理再转换：

插入新的一列

使用 trim 函数清除单元格 - 填充

选中整列 - 右键按住单元格左边框拉到原始列 - 仅复制数值

原地转换：

ESC 键退出单元格编辑

选中整列 - 按住鼠标右键拉动到其他列 - 拉动会原始列 - 仅复制数值

### 不使用公式进行计算

利用选择性粘贴将复制的单元格以运算的方式粘贴到目标单元格

复制要加的数 - 选中参与运算的单元格 -右键 - 选择性粘贴 - 运算

### 使用 F9 键调试公式

利用调试， 分步让公式中的计算返回结果， 从而就可以将复杂的问题简单化

选中函数参数 - 按 F9 显示计算结果（注意这时不要按回车，要 Ctrl + Z 撤销操作）

按照上面步骤扩大或缩小范围 - 知道找出错误

多次使用 F9 键之后直接按 ESC 退出编辑

### 定义名称

单元格定义名称: 选中单元格 - 左上角命名单元格

公式中使用单元格名称：选中要引用的单元格 - 按下 F3 - 选择单元格名称 - 回车

数据区域定义名称: 选中数据区域 - 左上角定义名称

名称管理：公式 - 名称管理器

### 从多个工作表汇总数据

工作表的布局完全相同时通过组合工作表来简化操作

复制工作表：按住 Ctrl 键 - 左键拖动到空白处

目标单元格输入 sum - 点击首工作表 - 按住 Shift 键 - 点击尾工作表 - 点击源数据单元格 - 回车

## 公式和函数工具

### 公式中的计算优先级

乘除的优先级高于加减

乘方的优先级高于乘法（例如计算 9 的平方根：`=A1^(1/2)`）

`()` 中的优先级最高

### 利用公式选项卡查找函数

Excel 内部公式选项卡中的函数分类可以快速找到需要的函数

查看帮助可以打开函数的说明文档

### 学习不熟悉的函数

使用插入函数按钮书写公式可以搜索公式， 直接看到公式的帮助信息和参数的说明。 这样，就可以帮助我们快速地掌握它们的正确用法。

### 自动求和

快捷键：`Alt + =`

行直接在目标单元格输入`Alt + =`，即可自动识别该行数值类型的单元格并进行求和

多行求和选中全部行后面的空白单元格区域，然后按下 `Alt + =`

多列求和可以选中全部列底下的空白单元格区域，然后按下 `Alt + =`

列求和可以选中该列要求和的单元格区域，然后按下`Alt + =`，求和结果将出现在下一行

### 相对引用和绝对引用

相对引用：引用的单元格会随着填充位置的变化而变化

绝对引用：引用的单元格不会随着填充位置的变化而变化

F4 键：相对引用和绝对引用互相切换

`$` 符号： 告诉 Excel 在复制公式时，不要修改这一个引用的行号和列号

### 混合引用

相对引用和绝对引用相结合

混合引用的关键： 对于公式中的每个引用，首先要确认用途，根据用途找出不变的部分，把不变的部分设置为绝对引用

### 用状态栏自动进行计算

了解数据的概况，可包含 6 种统计指标

状态栏显示中文格式：开始 - 会计数字格式 - 中文

## IF 及其相关函数

### IF 逻辑判断

用法：

IF 函数需要 3 个参数

IF(判断条件, 条件为真时的返回值, 条件为假时的返回值)

=IF(H2>3,5000,"") 如果 H2 大于 3，就返回 5000，否则返回空字符串

=IF(H2>3,K1,"") 如果 H2 大于 3，则引用 K1，否则返回空字符串

### 嵌套 IF 语句

将第三个参数替换为 IF 判断

=IF(H2>3,5000,IF(H2=3,3000,"")) 如果 H2 大于 3，就返回 5000，否则继续判断 H2 是否等于 3，是的话返回 3000，否则返回空字符串

=IF(H2>3,5000,IF(H2=3,3000,IF(H2=2,1500,""))) 根据以上规则，继续嵌套 IF 判断

### 在 IF 函数中使用 and，or 或 not 函数

整合多个条件（即同时满足多个条件）

and 函数：所有参数都返回 TRUE 才会返回 TRUE

or 函数：有一个参数都返回 TRUE 就会返回 TRUE

NOT 函数：对传入的参数进行取反

=IF(AND(G2="全职",I2>3,E2>4),5000,"") 当 G2 的值是全职且 I2 大于 3 且 E2 大于 4 时，返回 5000，否则返回空字符串

=IF(OR(G2="全职",I2>3,E2>4),5000,"") 当 G2 的值是全职或 I2 大于 3 或 E2 大于 4 时，返回 5000，否则返回空字符串

=IF(NOT(G2="全职"),500,IF(I2>3,5000,2000)) 如果 G2 不是全职，则返回 500，否则继续判断：若 I2 大于 3,则返回 5000，否则返回 2000

### 在 IFS 函数中使用多个条件

它可以检查是否满足一个或多个条件， 并返回第一个与初条件对应的值

优点：可读性更好，更容易理解

formlatext 函数: 输出单元格的公式

## 查找和引用函数(第四章)

### 使用 VLOOKUP 和 HLOOKUP 查找信息

功能完全相同

VLOOKUP: 垂直方向查询

HLOOKUP: 水平方向查询

### 模糊查询

必须对首列进行升序排序

### 精确匹配

第四个参数输入 False 却换到精确匹配

可以使用 trim 函数清除参数中的空格，提高公式的容错性

### 嵌套 VLOOKUP 函数

### 在大型列表中使用 VLOOKUP 函数

### CHOOSE 函数

基于一个值返回另一个值

### SWITCH 函数

功能跟 ifs 函数相同，但更容易理解

### MATCH 函数

用于查找数据

查找一个值是否存在于数组中，如果找到，就返回该值在数组中的行号

match(要查找的值，要查找的数组，匹配类型)

iferror(match(要查找的值，要查找的数组，匹配类型), "未找到") 处理错误信息

### 通过位置获取信息

Index 函数：返回指定行列交叉处的值或引用

index(查找区域，定位的行值，[定位的列值)

### 结合使用 MATCH 和 INDEX 函数

实现类似 Vlookup 的功能，更加灵活

1. 使用 match 函数获取目标值的行号
2. 把获取到的刚好带入 index 函数，得到该行号对应的值

## 汇总函数

### 单一条件汇总

COUNTIF: 计算某个区域中满足条件的单元格数量

COUNTIF(要查找的数据区域，需要满足的条件)

SUMIF：对满足条件的单元格进行求和

SUMIF(要查找的数据区域，需要满足的条件，要计算的数据)

AVERAGEIF：对满足条件的单元格求平均值

AVERAGEIF(要查找的数据区域，需要满足的条件，要计算的数据)

### 多条件汇总

COUNTIFS: 基于多个条件计算某个区域中的单元格数量

SUMIFS：对满足多个条件的单元格进行求和

AVERAGEIFS：对满足多个条件的单元格求平均值

### MAXIFS 和 MINIFS 函数

### 避免重复汇总

## 统计函数

### 找到中位数和众数

### 无需排序计算排名

### 使用 LARGE 和 SMALL 函数计算最大值/最小值

### 使用 COUNTBLANK 函数计算空白单元格

### COUNT，COUNTA 和状态栏

### 数学函数

## 使用 ROUND，ROUNDUP 和 ROUNDDOWN 函数

### 使用 MROUND、CEILING 和 FLOOR 函数

### 使用 INT 和 TRUNC 函数进行取整

### 使用 MOD 计算余数和应用条件格式

### 随机数函数的实际应用

### 度量衡换算函数

### 使用 AGGREGATE 函数忽略错误和隐藏据

### 使用 ROMAN 和 ARABIC 函数显示数字

## 日期和时间函数

### 公式中的日期和时间值

将日期和时间转化成数值，然后进行计算

点击功能区的逗号按钮可以将日期转换成数值

时间可以表示为它占一天的比值

输入 12 p -> 12:00 PM

输入 6 a -> 6:00 AM

### 使用时间和日期函数

#### 合并日期

Date 函数：将数值组合成日期

#### 拆分日期

year 函数：获取日期中的年份

month 函数：获取日期中的月份

day 函数：获取日期中的天

#### 构建时间

time 函数：将数值组合成时间 （设置单元格格式 -> Ctrl + 1）

#### 拆分时间

hour 函数：获取时间中的小时

minute 函数：获取时间中的分钟

second 函数：获取时间中的秒

### 使用 TODAY 和 NOW 函数动态创建日期和时间项

对时间进行动态处理

快速输入当前日期：Ctrl + ；

快速输入当前时间：Ctrl + shift + ;

today 函数：动态获取当前日期

now 函数：动态获取当前时间

dateif 函数：计算两个日期之间的年数

应用 1. 计算当前日期距离某个日期的天数（快速转换成常规格式：ctrl + shift + `）

应用 2. 使用 dateif 函数函数计算年龄

### 使用 WEEKDAY 函数标识一周中的第几天

### 使用 NETWORKDAYS 函数计算工作天数

### 使用 WORKDAY 函数确定结束日期

### 使用 DATEDIF 函数计算日期间隔

### 使用 EDATE 和 EOMONTH 函数计算与月份相关的日期

## 数组公式和函数

## 引用函数

### OFFSET 函数

引用：基于其他单元格的数据进行操作

offset 函数：利用单元格引用和偏移量，获得目标单元格或目标区域的数据

offset(引用位置->基于的位置，行偏移量，列偏移量->同一列为 0)

offset 函数应用：计算最新日期、最新销量、最近 3 天平均销量、最近 5 天平均销量

最新日期：

1. 使用 counta 函数获取列中的非空单元格数量

2. 将 counta 函数的计算结果作为 offset 函数的第 2 个参数

最近 3 天平均销量：

1. 使用 offset 函数计算基于第 1 行到倒数第 3 行开始的偏移量

2. 将 offset 函数的计算结果作为参数传入 average 函数，得出最后的平均数

### INDIRECT 函数

INDIRECT 函数用于返回引用

## 文本函数

## 信息类函数
